<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cloud Instance Recommender</title>
    <link rel="stylesheet" href="style.css" />
    <!-- JavaScript Files in Correct Order -->
    <script defer src="client_file_handling.js"></script>
    <script defer src="file_handling_integration.js"></script>
    <script defer src="script.js"></script>
  </head>

  <body>
    <div class="container">
      <header class="header">
        <h1>üåê Cloud Instance Recommender</h1>
        <p>
          Generate optimal instance recommendations for AWS, Azure, and GCP
          based on your current usage data
        </p>
      </header>

      <main class="main-content">
        <!-- Sample CSV Template Section -->
        <section class="section">
          <div class="section-header" onclick="toggleSection(this)">
            <span class="section-icon">üìÑ</span>
            <h2 class="section-title">Sample CSV Template</h2>
            <span class="toggle-icon">‚ñ≤</span>
          </div>
          <div class="section-content">
            <p style="margin-bottom: 20px">
              View and download the standard CSV format for optimal
              auto-mapping:
            </p>

            <div class="sample-csv">
              <pre>
              VM Name,CPU Count,Memory (GB),CPU Utilization,Memory Utilization,AWS Region,Azure Region,GCP Region
              web-server-01,4,16,45,60,us-east-1,East US,us-central1-a
              db-server-02,8,32,70,80,us-west-2,West US 2,us-west1-b
              app-server-03,2,8,35,45,eu-west-1,North Europe,europe-west1-c
              </pre>
            </div>

            <button class="btn btn-secondary" onclick="downloadSampleCSV()">
              üì• Download Sample CSV
            </button>
          </div>
        </section>

        <!-- File Upload Section -->
        <section class="section">
          <div class="section-header">
            <span class="section-icon">üìÅ</span>
            <h2 class="section-title">Upload CSV File</h2>
          </div>
          <div class="section-content">
            <div class="form-group">
              <div class="file-upload">
                <input type="file" id="csvFile" accept=".csv" />
                <label for="csvFile" class="file-upload-label">
                  <div style="font-size: 2rem; margin-bottom: 10px">üì§</div>
                  <div><strong>Click to upload CSV file</strong></div>
                  <div style="color: #666; margin-top: 5px">
                    or drag and drop your file here
                  </div>
                </label>
              </div>
            </div>
            <div id="fileStatus" class="hidden"></div>
            <!-- Placeholders for stats and preview -->
            <div id="fileStatsSection" class="hidden"></div>
            <div id="dataPreviewSection" class="hidden"></div>
          </div>
        </section>

        <!-- Cloud Provider Selection -->
        <section class="section">
          <div class="section-header">
            <span class="section-icon">‚òÅÔ∏è</span>
            <h2 class="section-title">Cloud Provider Selection</h2>
          </div>
          <div class="section-content">
            <div class="form-group">
              <label class="form-label">Select Cloud Providers:</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="aws"
                    value="aws"
                    onchange="toggleCloudProvider('aws')"
                  />
                  <label for="aws">üî∂ AWS</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="azure"
                    value="azure"
                    onchange="toggleCloudProvider('azure')"
                  />
                  <label for="azure">üî∑ Azure</label>
                </div>
                <div class="checkbox-item">
                  <input
                    type="checkbox"
                    id="gcp"
                    value="gcp"
                    onchange="toggleCloudProvider('gcp')"
                  />
                  <label for="gcp">üî¥ GCP</label>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Recommendation Type -->
        <section class="section">
          <div class="section-header">
            <span class="section-icon">‚öôÔ∏è</span>
            <h2 class="section-title">Recommendation Type</h2>
          </div>
          <div class="section-content">
            <div class="radio-group">
              <div class="radio-item">
                <input
                  type="radio"
                  id="likeToLike"
                  name="recommendationType"
                  value="like-to-like"
                  onchange="handleRecommendationTypeChange()"
                />
                <label for="likeToLike">
                  <strong>Like-to-Like Recommendation</strong><br />
                  <small
                    >Recommends instances with equal or higher CPU and memory
                    (cheapest option)</small
                  >
                </label>
              </div>
              <div class="radio-item">
                <input
                  type="radio"
                  id="optimized"
                  name="recommendationType"
                  value="optimized"
                  onchange="handleRecommendationTypeChange()"
                />
                <label for="optimized">
                  <strong>Optimized Recommendation</strong><br />
                  <small
                    >Recommends instances based on actual utilization
                    data</small
                  >
                </label>
              </div>
              <div class="radio-item">
                <input
                  type="radio"
                  id="both"
                  name="recommendationType"
                  value="both"
                  onchange="handleRecommendationTypeChange()"
                />
                <label for="both">
                  <strong>Both</strong><br />
                  <small
                    >Generates both like-to-like and optimized
                    recommendations</small
                  >
                </label>
              </div>
            </div>

            <!-- Optimization Controls -->
            <div id="optimizationControls" class="optimization-controls hidden">
              <h3 style="margin-bottom: 20px">üß† Optimization Settings</h3>

              <div class="form-group">
                <label class="form-label">Optimization Mode:</label>
                <div class="checkbox-group">
                  <div class="checkbox-item">
                    <input
                      type="checkbox"
                      id="cpuBased"
                      value="cpu"
                      onchange="toggleOptimizationMode()"
                    />
                    <label for="cpuBased">CPU-Based</label>
                  </div>
                  <div class="checkbox-item">
                    <input
                      type="checkbox"
                      id="memoryBased"
                      value="memory"
                      onchange="toggleOptimizationMode()"
                    />
                    <label for="memoryBased">Memory-Based</label>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">Downsizing Strategy:</label>
                <div class="radio-group">
                  <div class="radio-item">
                    <input
                      type="radio"
                      id="halfUsage"
                      name="downsizing"
                      value="half"
                    />
                    <label for="halfUsage">N/2 - Half of current usage</label>
                  </div>
                  <div class="radio-item">
                    <input
                      type="radio"
                      id="closestLower"
                      name="downsizing"
                      value="n-1"
                    />
                    <label for="closestLower"
                      >N-1 - Closest lower configuration</label
                    >
                  </div>
                </div>
              </div>

              <!-- CPU Utilization Ranges -->
              <div class="form-group hidden" id="cpuUtilizationRanges">
                <label
                  class="form-label"
                  style="color: #667eea; font-weight: 700"
                  >üíª CPU Utilization Ranges:</label
                >
                <div class="range-input">
                  <span>CPU Downsizing:</span>
                  <input
                    type="number"
                    id="cpuDownsizeMin"
                    value="0"
                    min="0"
                    max="100"
                    readonly
                    style="background: #f8f9fa"
                  />
                  <span>% to</span>
                  <input
                    type="number"
                    id="cpuDownsizeMax"
                    value="60"
                    min="0"
                    max="100"
                    onchange="updateCpuRanges()"
                  />
                  <span>%</span>
                </div>
                <div class="range-input">
                  <span>CPU Keep Same (N):</span>
                  <input
                    type="number"
                    id="cpuKeepMin"
                    value="60"
                    min="0"
                    max="100"
                    readonly
                    style="background: #f8f9fa"
                  />
                  <span>% to</span>
                  <input
                    type="number"
                    id="cpuKeepMax"
                    value="85"
                    min="0"
                    max="100"
                    onchange="updateCpuRanges()"
                  />
                  <span>%</span>
                </div>
                <div class="range-input">
                  <span>CPU Upsizing (N+1):</span>
                  <input
                    type="number"
                    id="cpuUpsizeMin"
                    value="85"
                    min="0"
                    max="100"
                    readonly
                    style="background: #f8f9fa"
                  />
                  <span>% to 100%</span>
                </div>
              </div>

              <!-- Memory Utilization Ranges -->
              <div class="form-group hidden" id="memoryUtilizationRanges">
                <label
                  class="form-label"
                  style="color: #4ecdc4; font-weight: 700"
                  >üß† Memory Utilization Ranges:</label
                >
                <div class="range-input">
                  <span>Memory Downsizing:</span>
                  <input
                    type="number"
                    id="memoryDownsizeMin"
                    value="0"
                    min="0"
                    max="100"
                    readonly
                    style="background: #f8f9fa"
                  />
                  <span>% to</span>
                  <input
                    type="number"
                    id="memoryDownsizeMax"
                    value="60"
                    min="0"
                    max="100"
                    onchange="updateMemoryRanges()"
                  />
                  <span>%</span>
                </div>
                <div class="range-input">
                  <span>Memory Keep Same (N):</span>
                  <input
                    type="number"
                    id="memoryKeepMin"
                    value="60"
                    min="0"
                    max="100"
                    readonly
                    style="background: #f8f9fa"
                  />
                  <span>% to</span>
                  <input
                    type="number"
                    id="memoryKeepMax"
                    value="85"
                    min="0"
                    max="100"
                    onchange="updateMemoryRanges()"
                  />
                  <span>%</span>
                </div>
                <div class="range-input">
                  <span>Memory Upsizing (N+1):</span>
                  <input
                    type="number"
                    id="memoryUpsizeMin"
                    value="85"
                    min="0"
                    max="100"
                    readonly
                    style="background: #f8f9fa"
                  />
                  <span>% to 100%</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Advanced Filtering -->
        <section class="section collapsed">
          <div class="section-header" onclick="toggleSection(this)">
            <span class="section-icon">üîß</span>
            <h2 class="section-title">
              Advanced Instance Filtering (Optional)
            </h2>
            <span class="toggle-icon">‚ñº</span>
          </div>
          <div class="section-content">
            <div class="form-group">
              <div class="checkbox-item">
                <input
                  type="checkbox"
                  id="excludeTypes"
                  onchange="toggleExcludeTypes()"
                />
                <label for="excludeTypes"
                  >Exclude specific instance types</label
                >
              </div>
            </div>

            <div id="excludeControls" class="hidden">
              <div class="grid-3" id="excludeTypeControls"></div>
            </div>

            <div class="form-group" style="margin-top: 30px">
              <div class="checkbox-item">
                <input
                  type="checkbox"
                  id="restrictFamilies"
                  onchange="toggleRestrictFamilies()"
                />
                <label for="restrictFamilies"
                  >Restrict to selected instance families only</label
                >
              </div>
            </div>

            <div id="familyControls" class="hidden">
              <div class="grid-3" id="familyTypeControls"></div>
            </div>
          </div>
        </section>

        <!-- Generate Recommendations -->
        <section class="section">
          <div class="section-header">
            <span class="section-icon">üöÄ</span>
            <h2 class="section-title">Generate Recommendations</h2>
          </div>
          <div class="section-content">
            <button
              class="btn btn-primary"
              onclick="generateRecommendations()"
              style="width: 100%; font-size: 1.2rem; padding: 20px"
            >
              üîÑ Generate Recommendations
            </button>

            <div id="processingStatus" class="hidden">
              <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
              </div>
              <div
                style="text-align: center; margin-top: 10px"
                id="progressText"
              >
                Processing...
              </div>
            </div>

            <div
              id="downloadSection"
              class="hidden"
              style="margin-top: 20px; text-align: center"
            >
              <div class="alert alert-success">
                <span style="margin-right: 10px">‚úÖ</span>
                Recommendations generated successfully!
              </div>
              <button class="btn btn-primary" onclick="downloadResults()">
                üì• Download Results CSV
              </button>
            </div>
          </div>
        </section>
      </main>
    </div>
  </body>
</html>
